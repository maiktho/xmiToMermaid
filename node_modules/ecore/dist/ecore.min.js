(function(){"use strict";function a(a){var c=a.eClass;if(c){var d=c.get("eAllStructuralFeatures");s.each(d,function(c){b(a,c)})}}function b(a,b){if(a&&b){var c=b.get("name"),d=b.values.defaultValue,e=b.get("upperBound"),f=b.values.derived===!0,g=(b.values.containment===!0,a.values[c]),h=function(){var a;return a=null===d||void 0===d?null:0===d?0:d===!1?!1:d};(null===g||void 0===g)&&(f?a.values[c]=b.values._:1!==e&&e?g instanceof t.EList?g._setFeature(b):a.values[c]=b.isTypeOf("EAttribute")?[]:new t.EList(a,b):a.values[c]=h())}}function c(a,b){return s.find(a.get("eAllStructuralFeatures"),function(a){return a.values.name===b})}function d(a,b){if(a.eClass){var d=function(a,b){return"function"==typeof b?b:b instanceof v?b:t.create(a,b)},e=function(b,c,e,f){e?a.set(b,d(f,c)):a.set(b,c)},f=function(b,c,e,f){var g=s.isArray(c)?c:[c];s.each(g,function(c){e?a.get(b).add(d(f,c)):a.get(b).push(c)})};s.each(b,function(a,b){var d=c(this.eClass,b);d&&void 0!==a&&(1===d.get("upperBound")?e(b,a,d.eClass===t.EReference,d.get("eType")):f(b,a,d.eClass===cb,d.get("eType")))},a)}}function e(a){var b=a.get("eOperations").array(),c=a.get("eAllSuperTypes"),d=s.flatten(s.union(b||[],s.map(c||[],function(a){return e(a)})));return d}function f(a){if(a&&a.eClass){var b=e(a.eClass);b&&s.each(b,function(b){a[b.get("name")]=b._})}}function g(a){var b={},c=a.get("contents").array();if(c.length){var d,e,f=function(a,c){var d=a.eContents();b[c]=a,s.each(d,function(a){f(a,a.fragment())})};if(1===c.length)d=c[0],d._id?f(d,d._id):(e=d.eClass.get("eIDAttribute")||null,e?f(d,d.get(e.name)):f(d,"/"));else for(var g=0;g<c.length;g++)d=c[g],d._id?f(d,d._id):(e=d.eClass.get("eIDAttribute")||null,e?f(d,d.get(e.name)):f(d,"/"+g))}return b}function h(a){return!a.get("abstract")}function i(a){if(!a||!a.eClass)return[];var b=a.get("eAllSubTypes");return s.filter(s.union([a],b),h)}function j(a,b){if(!a)return[];var c=a.eClass.get("eAllContainments"),d=function(c){var d=i(c.get("eType"));return b&&"function"==typeof b?b(a,c,d):d};return s.flatten(s.map(c,d))}function k(a,b){if(!a)return[];var c=a.eContainer,d=j(c,b);return d}function l(a,b,c){return s.map(c,function(c){return{label:"New "+c.get("name"),owner:a,feature:b,type:c}})}function m(a){return j(a,l)}function n(a){return k(a,l)}function o(a){return a.get("name")||""}function p(a){var b=a.get("eType"),c=a.eClass===t.EOperation,d=b?b.get("name"):null;return a.get("name")+(c?"()":"")+(d?" : "+d:"")}function q(a,b){if(null==a||null==a.eResource()||null==a.eResource().get("resourceSet"))throw new Error("Bad argument");var c=b.get("eType"),d=a.eResource().get("resourceSet"),e=d.elements();return s.filter(e,function(a){return a.isKindOf(c)})}var r=this,s=r._;s||"undefined"==typeof require||(s=require("underscore"));var t={create:function(a,b){var c,d;if(b?(c=b,c.eClass=b.eClass||a):a instanceof v?(c={},c.eClass=a):c=a,!c.eClass||c.eClass.get("abstract"))throw new Error("Cannot create EObject from undefined or abstract EClass");return d=new v(c)}};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.Ecore=t):r.Ecore=t;var u={on:function(a,b,c){var d,e,f;if(!b)return this;for(a=a.split(/\s+/),d=this._callbacks||(this._callbacks={});e=a.shift();)f=d[e]||(d[e]=[]),f.push(b,c);return this},off:function(a,b,c){var d,e,f,g;if(!(e=this._callbacks))return this;if(!(a||b||c))return delete this._callbacks,this;for(a=a?a.split(/\s+/):s.keys(e);d=a.shift();)if((f=e[d])&&(b||c))for(g=f.length-2;g>=0;g-=2)b&&f[g]!==b||c&&f[g+1]!==c||f.splice(g,2);else delete e[d];return this},trigger:function(a){var b,c,d,e,f,g,h,i;if(!(c=this._callbacks))return this;for(i=[],a=a.split(/\s+/),e=1,f=arguments.length;f>e;e++)i[e-1]=arguments[e];for(;b=a.shift();){if((h=c.all)&&(h=h.slice()),(d=c[b])&&(d=d.slice()),d)for(e=0,f=d.length;f>e;e+=2)d[e].apply(d[e+1]||this,i);if(h)for(g=[b].concat(i),e=0,f=h.length;f>e;e+=2)h[e].apply(h[e+1]||this,g)}return this}},v=function(b){return b||(b={}),this.eClass=b.eClass,this.values={},b._&&(this._=b._),a(this),d(this,b),f(this),this};t.EObjectPrototype={setEClass:function(b){return this.eClass=b,a(this),d(this,this.values),f(this),this},create:function(a){return"EClass"===this.eClass.get("name")?t.create(this,a):void 0},has:function(a){return this.values.hasOwnProperty(a)||c(this.eClass,a)},isSet:function(a){if(!this.has(a))return!1;var b=this.eClass;if(!b)return!1;var c=this.get(a);return c instanceof w?c.size()>0:null!==c&&"undefined"!=typeof c},set:function(a,b){var c,d,e,f;if(null===a)return this;a.eClass&&(a=a.get("name")),s.isObject(a)||(d=a,(a={})[d]=b,b=arguments[2]);var g=this.eResource();for(c in a)e=a[c],"undefined"!=typeof e&&this.has(c)&&(this.values[c]=e,f="change:"+c,this.trigger("change "+f,c),g&&g.trigger("change",this));return this},get:function(a){if(!a)return null;var d=a.eClass?a.get("name"):a;!s.has(this.values,d)&&this.has(d)&&b(this,c(this.eClass,d));var e=this.values[d];return"function"==typeof e?e.apply(this):e},isTypeOf:function(a){if(!a||!this.eClass)return!1;var b=a.eClass?a.get("name"):a;return this.eClass.get("name")===b},isKindOf:function(a){if(!a||!this.eClass)return!1;if(this.isTypeOf(a))return!0;var b=a.eClass?a.get("name"):a,c=this.eClass.get("eAllSuperTypes");return s.any(c,function(a){return a.get("name")===b})},eResource:function(){return this.isKindOf("Resource")?this:this.eContainer?this.eContainer.isKindOf("Resource")?this.eContainer:this.eContainer.eResource():null},eContents:function(){if(!this.eClass)return[];if(s.isUndefined(this.__updateContents)){this.__updateContents=!0;var a=this.eResource();if(a){var b=this;a.on("add remove",function(){b.__updateContents=!0})}}if(this.__updateContents){var c=this.eClass.get("eAllStructuralFeatures"),d=s.filter(c,function(a){return a.isTypeOf("EReference")&&a.get("containment")&&this.isSet(a.get("name"))},this),e=null;this.__eContents=s.flatten(s.map(d,function(a){return e=this.get(a.get("name")),e?e.array?e.array():e:[]},this)),this.__updateContents=!1}return this.__eContents},eURI:function(){var a=this.eResource();return a.get("uri")+"#"+this.fragment()},fragment:function(){var a,b,c,d=this.eContainer,e=this.eClass,f=e.get("eIDAttribute");return d?f?this.get(f.get("name")):this._id?this._id:this.isKindOf("EModelElement")?d?d.isKindOf("Resource")?(b=d.get("contents"),b.size()>1?"/"+b.indexOf(this):"/"):d.fragment()+"/"+this.get("name"):"/":(d.isKindOf("Resource")?(b=d.get("contents"),c=b.size()>1?"/"+b.indexOf(this):"/"):(a=this.eContainingFeature,a&&(c=d.fragment()+"/@"+a.get("name"),1!==a.get("upperBound")&&(c+="."+d.get(a.get("name")).indexOf(this)))),c):null}},s.extend(v.prototype,t.EObjectPrototype,u);var w=t.EList=function(a,b){return this._internal=[],this._owner=a,this._size=0,this._setFeature(b),this};w.prototype={_setFeature:function(a){a&&(this._feature=a,this._isContainment=this._feature.get("containment"),s.each(this._internal,function(a){this._isContainment&&(a.eContainer=this._owner,a.eContainingFeature=this._feature)},this))},add:function(a){if(!a||!a instanceof v)return this;this._isContainment&&(a.eContainingFeature=this._feature,a.eContainer=this._owner),this._size++,this._internal.push(a);var b=this._owner.eResource(),c="add";return this._feature&&(c+=":"+this._feature.get("name")),this._owner.trigger(c,a),b&&b.trigger("add",this),this},addAll:function(){return s.each(s.flatten(arguments||[]),function(a){this.add(a)},this),this},remove:function(a){var b="remove",c=this._owner.eResource();return this._internal=s.without(this._internal,a),this._size=this._size-1,this._feature&&(b+=":"+this._feature.get("name")),this._owner.trigger(b,a),c&&c.trigger("remove",this),this},clear:function(){for(var a=this.array(),b=0;b<a.length;b++)this.remove(a[b]);return this},size:function(){return this._size},at:function(a){if(this._size<a)throw new Error("Index Out Of Range");return this._internal[a]},array:function(){return this._internal},first:function(){return s.first(this._internal)},last:function(){return s.last(this._internal)},rest:function(a){return s.rest(this._internal,a)},each:function(a,b){return s.each(this._internal,a,b)},filter:function(a,b){return s.filter(this._internal,a,b)},find:function(a,b){return s.find(this._internal,a,b)},map:function(a,b){return s.map(this._internal,a,b)},reject:function(a,b){return s.reject(this._internal,a,b)},contains:function(a){return s.contains(this._internal,a)},indexOf:function(a){return s.indexOf(this._internal,a)}};var x=new v,y=new v,z=new v,A=new v,B=new v,C=new v,D=new v,E=new v,F=new v,G=new v,H=new v,I=new v;x.eClass=x,x.values={name:"EClass","abstract":!1,"interface":!1,eStructuralFeatures:new t.EList(x),eOperations:new t.EList(x),eSuperTypes:new t.EList(x),eAllSuperTypes:function(){if(!this._eAllSuperTypes){var a=function(a){var b=a.get("eSuperTypes").array(),c=s.flatten(s.map(b,function(a){return a.get("eAllSuperTypes")}));return s.union(c,b)};this.on("add:eSuperTypes remove:eSuperTypes",function(){this._eAllSuperTypes=a(this)},this),this._eAllSuperTypes=a(this)}return this._eAllSuperTypes},eAllSubTypes:function(){var a,b,c;return c=this.eResource().get("resourceSet"),a=c?c.elements("EClass"):t.EPackage.Registry.elements("EClass"),b=s.filter(a,function(a){return s.contains(a.get("eAllSuperTypes"),this)},this),s.isArray(b)?b:[]},eReferences:function(){var a,b;return a=this.get("eStructuralFeatures"),b=a.filter(function(a){return a.isTypeOf("EReference")})},eAttributes:function(){var a,b;return a=this.get("eStructuralFeatures"),b=a.filter(function(a){return a.isTypeOf("EAttribute")})},eIDAttribute:function(){var a,b;return a=this.get("eAllAttributes"),b=s.filter(a,function(a){return a.get("iD")===!0}),s.isArray(b)?null:b},eAllStructuralFeatures:function(){var a=function(a){var b,c,d;return d=a.get("eAllSuperTypes"),c=a.values.eStructuralFeatures.array(),b=s.flatten(s.map(d||[],function(a){return a.values.eStructuralFeatures.array()})),s.union(b||[],c||[])};return a(this)},eAllAttributes:function(){var a=this.get("eAllStructuralFeatures"),b=s.filter(a||[],function(a){return a.eClass===t.EAttribute});return b},eAllContainments:function(){var a=this.get("eAllStructuralFeatures"),b=s.filter(a,function(a){return a.eClass===t.EReference&&a.get("containment")});return b},eAllReferences:function(){var a=this.get("eAllStructuralFeatures"),b=s.filter(a,function(a){return a.eClass===t.EReference&&!a.get("containment")});return b}},E.values={name:"abstract",lowerBound:0,upperBound:1,defaultValueLiteral:"false",defaultValue:!1,eType:A},F.values={name:"interface",lowerBound:0,upperBound:1,defaultValueLiteral:"false",defaultValue:!1,eType:A},G.values={name:"eStructuralFeatures",lowerBound:0,upperBound:-1,containment:!0},I.values={name:"eSuperTypes",lowerBound:0,upperBound:-1,containment:!1},H.values={name:"eOperations",lowerBound:0,upperBound:-1,containment:!0},x.get("eStructuralFeatures").add(E).add(F).add(I).add(G).add(H);var J=new v;J.values={name:"eAllStructuralFeatures",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAllStructuralFeatures};var K=new v;K.values={name:"eAllSuperTypes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAllSuperTypes};var L=new v;L.values={name:"eAllSubTypes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAllSubTypes};var M=new v;M.values={name:"eAllAttributes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAllAttributes};var N=new v;N.values={name:"eAllContainments",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAllContainments};var O=new v;O.values={name:"eAllReferences",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAllReferences};var P=new v;P.values={name:"eReferences",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eReferences};var Q=new v;Q.values={name:"eAttributes",lowerBound:0,upperBound:-1,derived:!0,containment:!1,_:x.values.eAttributes};var R=new v;R.values={name:"eIDAttribute",lowerBound:0,upperBound:1,derived:!0,containment:!1,_:x.values.eIDAttribute},x.get("eStructuralFeatures").add(J).add(K).add(L).add(M).add(O).add(N).add(Q).add(P).add(R),x.getEStructuralFeature=function(a){var b;return b=a.eClass?a.get("name"):a,s.find(this.get("eAllStructuralFeatures"),function(a){return a.get("name")===b})};var S=new v;S.values={name:"getEStructuralFeature",lowerBound:0,upperBound:1,eParameters:new t.EList(this)},S._=x.getEStructuralFeature,x.get("eOperations").add(S),x.values.eStructuralFeatures._setFeature(G),x.values.eSuperTypes._setFeature(I),x.values.eOperations._setFeature(H);var T=x.create(),U=x.create(),V=x.create(),W=x.create(),X=x.create(),Y=x.create(),Z=x.create(),$=x.create(),_=x.create(),ab=x.create(),bb=x.create(),cb=x.create(),db=x.create(),eb=x.create(),fb=x.create();E.eClass=bb,F.eClass=bb,G.eClass=cb,G.values.eType=ab,I.eClass=cb,I.values.eType=x,H.eClass=cb,H.values.eType=db,J.eClass=cb,J.values.eType=ab,K.eClass=cb,K.values.eType=x,L.eClass=cb,L.values.eType=x,M.eClass=cb,M.values.eType=bb,O.eClass=cb,O.values.eType=cb,N.eClass=cb,N.values.eType=cb,Q.eClass=cb,Q.values.eType=bb,P.eClass=cb,P.values.eType=cb,R.eClass=cb,R.values.eType=bb,S.eClass=db,S.values.eType=ab,U.get("eSuperTypes").add(T),V.get("eSuperTypes").add(U),W.get("eSuperTypes").add(U),X.get("eSuperTypes").add(W),Y.get("eSuperTypes").add(W),x.get("eSuperTypes").add(Y),Z.get("eSuperTypes").add(Y),$.get("eSuperTypes").add(Z),fb.get("eSuperTypes").add(W),_.get("eSuperTypes").add(W),ab.get("eSuperTypes").add(_),bb.get("eSuperTypes").add(ab),cb.get("eSuperTypes").add(ab),db.get("eSuperTypes").add(_),eb.get("eSuperTypes").add(_);var gb=new v,hb=new v,ib=new v,jb=new v,kb=new v,lb=new v,mb=new v;gb.eClass=cb,gb.values={name:"eType",lowerBound:0,upperBound:1,containment:!1,eType:Y},hb.eClass=bb,hb.values={name:"ordered",lowerBound:0,upperBound:1,defaultValueLiteral:"true",defaultValue:!0,eType:A},ib.eClass=bb,ib.values={name:"unique",lowerBound:0,upperBound:1,defaultValueLiteral:"true",defaultValue:!0,eType:A},jb.eClass=bb,jb.values={name:"lowerBound",lowerBound:0,upperBound:1,defaultValueLiteral:"0",defaultValue:0,eType:z},kb.eClass=bb,kb.values={name:"upperBound",lowerBound:0,upperBound:1,defaultValueLiteral:"1",defaultValue:1,eType:z},lb.eClass=bb,lb.values={name:"many",lowerBound:0,upperBound:1,eType:A,derived:!0,_:function(){return 1!==this.get("upperBound")}},mb.eClass=bb,mb.values={name:"required",lowerBound:0,upperBound:1,eType:A,derived:!0,_:function(){return 1===this.get("lowerBound")}},_.get("eStructuralFeatures").add(gb).add(hb).add(ib).add(jb).add(kb).add(lb).add(mb);var nb=new v;nb.eClass=cb,nb.values={name:"eAnnotations",eType:V,lowerBound:0,upperBound:-1,containment:!0},U.get("eStructuralFeatures").add(nb);var ob=new v;ob.eClass=bb,ob.values={name:"name",lowerBound:0,upperBound:1,eType:y},W.get("eStructuralFeatures").add(ob);var pb=bb.create({name:"changeable",eType:A}),qb=bb.create({name:"volatile",eType:A}),rb=bb.create({name:"transient",eType:A}),sb=bb.create({name:"defaultValueLiteral",eType:y}),tb=bb.create({name:"defaultValue",eType:D,derived:!0}),ub=bb.create({name:"unsettable",eType:A}),vb=bb.create({name:"derived",eType:A});ab.get("eStructuralFeatures").add(pb).add(qb).add(rb).add(sb).add(tb).add(ub).add(vb),tb.set({derived:!0});var wb=bb.create({name:"containment",eType:A}),xb=bb.create({name:"container",eType:A}),yb=bb.create({name:"resolveProxies",eType:A}),zb=cb.create({name:"eOpposite",eType:cb});cb.get("eStructuralFeatures").add(wb).add(xb).add(yb).add(zb);var Ab=bb.create({name:"iD",eType:A});bb.get("eStructuralFeatures").add(Ab),T.set({name:"EObject"}),U.set({name:"EModelElement","abstract":!0}),V.set({name:"EAnnotation"}),W.set({name:"ENamedElement","abstract":!0}),X.set({name:"EPackage"}),Y.set({name:"EClassifier","abstract":!0}),Z.set({name:"EDataType"}),$.set({name:"EEnum"}),_.set({name:"ETypedElement","abstract":!0}),ab.set({name:"EStructuralFeature","abstract":!0}),bb.set({name:"EAttribute"}),cb.set({name:"EReference"}),db.set({name:"EOperation"}),eb.set({name:"EParameter"}),fb.set({name:"EEnumLiteral"});var Bb=cb.create({name:"eParameters",eType:eb,containment:!0,lowerBound:0,upperBound:-1});db.get("eStructuralFeatures").add(Bb);var Cb=cb.create({name:"eLiterals",eType:fb,containment:!0,lowerBound:0,upperBound:-1});$.get("eStructuralFeatures").add(Cb),fb.get("eStructuralFeatures").add(bb.create({name:"literal",eType:y})).add(bb.create({name:"value",eType:z}));var Db=x.create({name:"EStringToStringMapEntry"}),Eb=bb.create({name:"key",lowerBound:0,upperBound:1,eType:y}),Fb=bb.create({name:"value",lowerBound:0,upperBound:1,eType:y});Db.get("eStructuralFeatures").add(Eb).add(Fb);var Gb=bb.create({name:"source",upperBound:1,lowerBound:0,eType:y}),Hb=cb.create({name:"details",upperBound:-1,lowerBound:0,containment:!0,eType:Db});V.get("eStructuralFeatures").add(Gb).add(Hb),y.eClass=Z,y.set({name:"EString"}),z.eClass=Z,z.set({name:"EInt"}),A.eClass=Z,A.set({name:"EBoolean"}),C.eClass=Z,C.set({name:"EDate"}),B.eClass=Z,B.set({name:"EDouble"}),D.eClass=Z,D.set({name:"JSObject"}),t.ELong=Z.create({name:"ELong"}),t.EFloat=Z.create({name:"EFloat"}),t.EShort=Z.create({name:"EShort"});var Ib=cb.create({name:"eClassifiers",lowerBound:0,upperBound:-1,containment:!0,eType:Y}),Jb=cb.create({name:"eSubPackages",lowerBound:0,upperBound:-1,containment:!0,eType:X});X.get("eStructuralFeatures").add(bb.create({name:"nsURI",eType:y})).add(bb.create({name:"nsPrefix",eType:y})).add(Ib).add(Jb),t.EcorePackage=X.create({name:"ecore",nsPrefix:"ecore",nsURI:"http://www.eclipse.org/emf/2002/Ecore"}),t.EcorePackage.get("eClassifiers").add(T).add(U).add(V).add(W).add(X).add(Y).add(x).add(Z).add(_).add(ab).add(bb).add(cb).add(db).add(eb).add($).add(fb).add(Db).add(y).add(A).add(z).add(B).add(C).add(t.EShort).add(t.EFloat).add(t.ELong).add(D),t.EObject=T,t.EModelElement=U,t.EClass=x,t.EClassifier=Y,t.EAnnotation=V,t.EStringToStringMapEntry=Db,t.EPackage=X,t.ETypedElement=_,t.ENamedElement=W,t.EStructuralFeature=ab,t.EAttribute=bb,t.EReference=cb,t.EEnum=$,t.EEnumLiteral=fb,t.EDataType=Z,t.EOperation=db,t.EParameter=eb,t.EString=y,t.EBoolean=A,t.EInt=z,t.EDouble=B,t.EDate=C,t.JSObject=D,t.EPackage.Registry={_ePackages:{},getEPackage:function(a){return this._ePackages[a]},register:function(a){if(!a.isSet("nsURI"))throw new Error("Cannot register EPackage without nsURI");a.get("eSubPackages").each(function(a){register(a)}),this._ePackages[a.get("nsURI")]=a},ePackages:function(){return s.values(this._ePackages)},elements:function(a){var b=function(b){return a?a.eClass?b.eClass===a:b.eClass.get("name")===a:!0},c=this.ePackages(),d=function(a){return s.map(a.eContents(),function(a){return[a,d(a)]})},e=function(a){return d(a)},f=[c,s.map(c,e)];return f=s.flatten(f),f=s.filter(f,b)}},t.EPackage.Registry.register(t.EcorePackage),t.$=r.jQuery||r.Zepto||r.ender||null;var Kb={get:function(a,b,c,d){return t.$?t.$.ajax({url:a,dataType:b,success:c,error:d}):void 0},post:function(a,b,c,d,e){return t.$?t.$.ajax({type:"POST",url:a,dataType:c,data:b,success:d,error:e}):void 0}};t.JSON={dataType:"json",contentType:"application/json",parse:function(a,b){function c(a,b){return a&&b?function(c){if(c&&!c.get("derived")){var d=c.get("name"),g=a[d];"undefined"!=typeof g&&(c.isTypeOf("EAttribute")?b.set(d,g):c.get("containment")?1===c.get("upperBound")?b.set(d,e(g)):s.each(g||[],function(a){b.get(d).add(e(a))}):f.push({parent:b,feature:c,value:g}))}}:function(){}}function d(){function b(a,b,d,e){var f=d.$ref,g=c[f];g||(g=h.getEObject(f)),g&&(e?a.get(b.get("name")).add(g):a.set(b.get("name"),g))}var c=g(a);s.each(f,function(a){var c=a.parent,d=a.feature,e=a.value;1===d.get("upperBound")?b(c,d,e,!1):s.each(e,function(a){b(c,d,a,!0)})})}function e(a){var b,d,e;if(a&&a.eClass){if(b=h.getEObject(a.eClass),!b)throw new Error("Cannot find EClass from href "+JSON.stringify(a.eClass));d=b.get("eAllStructuralFeatures"),e=b?t.create(b):null,e&&(a._id&&(e._id=a._id),s.each(d,c(a,e)))}return e}var f=[],h=a.get("resourceSet")||t.ResourceSet.create();s.isArray(b)?s.each(b,function(b){a.add(e(b))}):a.add(e(b)),d()},to:function(a){function b(a,b){var c=b.eResource(),d=a.eResource(),e=c!==d;if(c&&d){h[c.get("uri")]||(h[c.get("uri")]=g(c));var f=h[c.get("uri")];for(var i in f)if(f[i]===b)return e?c.get("uri")+"#"+i:i;return null}}function c(a,c,d){return d===!0?e(c):{$ref:b(a,c),eClass:c.eClass.eURI()}}function d(a,b){return a&&b?function(d,e){if("_"!==e[0]){var f=a.eClass.getEStructuralFeature(e),g=a.isSet(e);if(f&&g&&!f.get("derived")){var h=d,i=f.get("name"),j=1!==f.get("upperBound"),k=f.get("containment");f.isTypeOf("EAttribute")?b[i]=h:j?(b[i]=[],h.each(function(d){b[i].push(c(a,d,k))})):b[i]=c(a,h,k)}}}:function(){}}function e(a){var b=a.eClass,c=a.values,e={eClass:b.eURI()};return a._id&&(e._id=a._id),s.each(c,d(a,e)),e}var f=a.get("contents").array(),h={};h[a.get("uri")]=g(a);var i;if(1===f.length){var j=f[0];i=e(j)}else{i=[];for(var k=0;k<f.length;k++)i.push(e(f[k]))}return i}};var Lb=t.Resource=t.EClass.create({name:"Resource",eSuperTypes:[t.EObject],eStructuralFeatures:[{eClass:t.EAttribute,name:"uri",lowerBound:1,upperBound:1,eType:t.EString},{eClass:t.EReference,name:"contents",upperBound:-1,containment:!0,eType:t.EObject},{eClass:t.EReference,name:"resourceSet",upperBound:1,lowerBound:0,eType:t.ResourceSet}],eOperations:[{eClass:t.EOperation,name:"add",_:function(a){return a||a.eClass?(a.eContainer=this,this.get("contents").add(a),this):this}},{eClass:t.EOperation,name:"clear",_:function(){return this.get("contents").clear(),this}},{eClass:t.EOperation,name:"addAll",_:function(a){return s.isArray(a)&&s.each(a,function(a){this.add(a)},this),this}},{eClass:t.EOperation,name:"getEObject",eType:t.EObject,_:function(a){return a?this._index()[a]:null}},{eClass:t.EOperation,name:"each",_:function(a,b){return this.get("contents").each(a,b)}},{eClass:t.EOperation,name:"to",_:function(a,b){return a&&"function"==typeof a.to?a.to(this,b):t.JSON.to(this)}},{eClass:t.EOperation,name:"parse",_:function(a,b){return b&&"function"==typeof b.parse?b.parse(this,a):t.JSON.parse(this,a),this}},{eClass:t.EOperation,name:"save",_:function(a,b,c){c||(c={});var d=c.format?c.format:t.JSON,e=this.to(d),f=d.dataType,g=this.get("resourceSet"),h=g?g.uriConverter():null,i=this.get("uri");i=h?h.normalize(i):i,Kb.post(i,e,f,a,b)}},{eClass:t.EOperation,name:"load",_:function(a,b,c){c||(c={});var d=this,e=c.format||t.JSON,f=this.get("resourceSet"),g=f?f.uriConverter():null,h=this.get("uri"),i=function(b){return d.parse(b,e),d.trigger("change"),"function"==typeof a?a(d):void 0};return c.data?i(c.data):(f&&f.isSet("uri")&&(h=f.get("uri")+"/"+h),h=g?g.normalize(h):h,Kb.get(h,e.dataType,i,b))}},{eClass:t.EOperation,name:"remove",_:function(){var a=this.get("resourceSet");a&&a.get("resources").remove(this),this.clear()}},{eClass:t.EOperation,name:"_index",eType:D,_:function(){if(s.isUndefined(this.__updateIndex)){var a=this;a.__updateIndex=!0,a.on("add remove",function(){a.__updateIndex=!0})}return this.__updateIndex&&(this.__index=g(this),this.__updateIndex=!1),this.__index}}]}),Mb=function(){this.uriMap={}};Mb.prototype={map:function(a,b){this.uriMap[a]=b},normalize:function(a){var b=a.split("#"),c=b[0],d=this.uriMap[c];if(d)return d;var e,f,g=c.lastIndexOf("/")+1;return e=c.slice(0,g),e===c?a:(f=c.slice(g,c.length),this.normalize(e)+f)}};var Nb=t.ResourceSet=t.EClass.create({name:"ResourceSet",eSuperTypes:[t.EObject],eStructuralFeatures:[{eClass:t.EAttribute,name:"uri",upperBound:1,lowerBound:0,eType:t.EString},{eClass:t.EReference,name:"resources",upperBound:-1,containment:!0,eType:Lb}],eOperations:[{eClass:t.EOperation,eType:t.Resource,upperBound:1,name:"create",_:function(a){var b,c=s.isObject(a)?a:{uri:a};if(!c.uri)throw new Error("Cannot create Resource, missing URI parameter");return(b=this.get("resources").find(function(a){return a.get("uri")===c.uri}))?b:(b=t.Resource.create(c),b.set("resourceSet",this),this.get("resources").add(b),this.trigger("add",b),b)}},{eClass:t.EOperation,eType:t.EObject,upperBound:1,name:"getEObject",_:function(a){var b,c=a.split("#"),d=c[0],e=c[1];if(!e)return null;var f=t.EPackage.Registry.getEPackage(d);return f&&(b=f.eResource(),b||(b=this.create({uri:d}),b.add(f),this.get("resources").add(b),b.set("resourceSet",this))),b?b.getEObject(e):(b=this.get("resources").find(function(a){return a.get("uri")===d}),b?b.getEObject(e):null)}},{eClass:t.EOperation,eType:t.EObject,upperBound:-1,name:"elements",_:function(a){var b=function(b){return a?b.isKindOf(a):!0},c=this.get("resources").map(function(a){return s.filter(s.values(a._index()),b)});return s.flatten(c)}},{eClass:t.EOperation,eType:t.JSObject,upperBound:1,name:"uriConverter",_:function(){return this._converter||(this._converter=new Mb),this._converter}},{eClass:t.EOperation,eType:t.JSObject,upperBound:1,name:"toJSON",_:function(){var a={total:this.get("resources").size(),resources:[]};return this.get("resources").each(function(b){a.resources.push({uri:b.get("uri"),length:b.get("contents").size(),contents:b.get("contents").map(function(a){return{eURI:a.eURI(),eClass:a.eClass.eURI()}})})}),a}},{eClass:t.EOperation,name:"parse",_:function(a){a&&a.resources&&s.each(a.resources,function(a){a.uri&&resourceSet.create({uri:a.uri})},this)}},{eClass:t.EOperation,name:"fetch",_:function(a,b){var c=this.get("uri");if(c){var d=this,e=function(b){return d.parse(b),d.trigger("change"),"function"==typeof a?a(d):void 0};Kb.get(c,t.JSON.dataType,e,b)}}}]});Lb.getEStructuralFeature("resourceSet").set("eType",Nb);var Ob=t.EPackage.create({name:"resources",nsPrefix:"resources",nsURI:"http://www.eclipselabs.org/ecore/2012/resources",eClassifiers:[Nb,Lb]}),Pb=t.Resource.create({uri:t.EcorePackage.get("nsURI")});Pb.add(t.EcorePackage);var Qb=t.Resource.create({uri:Ob.get("nsURI")});Qb.add(Ob),t.EPackage.Registry.register(Ob),t.Edit={childTypes:j,siblingTypes:k,childDescriptors:m,siblingDescriptors:n,choiceOfValues:q,_get:function(a,b){if(!b||!b.eClass)return null;var c=b.eClass.get("name");return this[c]?"function"==typeof this[c][a]?this[c][a](b):this[c][a]:b.eClass.get("name")},text:function(a){return this._get("text",a)},icon:function(a){return this._get("icon",a)},label:function(a){return this._get("label",a)},EClass:{text:o,label:o,icon:"icon-EClass"},EDataType:{text:o,label:o,icon:"icon-EDataType"},EEnum:{text:o,label:o,icon:"icon-EEnum"},EEnumLiteral:{text:function(a){return a.get("name")+" = "+a.get("value")},label:o,icon:"icon-EEnumLiteral"},EAttribute:{text:p,label:o,icon:"icon-EAttribute"},EReference:{text:p,label:o,icon:"icon-EReference"},EOperation:{text:p,label:o,icon:"icon-EOperation"},EPackage:{text:o,label:o,icon:"icon-EPackage"},EAnnotation:{text:function(a){return a.get("source")},label:function(a){return a.get("source")},icon:"icon-EAnnotation"},EStringToStringMapEntry:{text:function(a){return a.get("key")+" -> "+a.get("value")},label:function(a){return a.get("key")},icon:"icon-EStringToStringMapEntry"},ResourceSet:{text:"resourceSet",label:"",icon:"icon-EObject"},Resource:{text:function(a){return a.get("uri")},label:function(a){return a.get("uri")},icon:"icon-EObject"}}}).call(this);